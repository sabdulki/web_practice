!function(){"use strict";var i=function(){return i=Object.assign||function(i){for(var t,n=1,e=arguments.length;n<e;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(i[o]=t[o]);return i},i.apply(this,arguments)};"function"==typeof SuppressedError&&SuppressedError;var t=window.adsConfig,n=window.location,e=window.rapidInstance,o=window.rapidPageConfig,a=window.YAHOO,r=window.wafer,d=a.context,l=d.meta,v=void 0===l?{}:l;d.site,v.siteAttribute,v.url;var u=r.utils.getUrlParameterValueByName,c=(o||{}).rapidConfig;c&&c.keys;var s,f=a.i13n&&a.i13n.SPACEID,p=new RegExp(/rs="([^"]*)"/),w=[];var m=function(i,o,a,r){var l,v,c=window.DARLA;if(c){var s=null===(l=null==i?void 0:i.meta)||void 0===l?void 0:l.data,w=null==s?void 0:s.adMeta,m="",g=c.evtSettings("AUTO")||{ps:{}},h={autoIV:1,autoMax:25,autoRT:"10000"},A=t.clusterPositionMeta,E=void 0===A?{}:A,y=E.siteAttributes,b=void 0===y?"":y,O=E.addAutoEvent,R=void 0!==O&&O,C="",P=d.ynet,L=d.bucket,I=d.device,D=d.intl,x=d.site,S=d.rid;"1"===P&&(-1!==(null===(v=null==n?void 0:n.search)||void 0===v?void 0:v.indexOf("_spaceid"))&&(m=g.sp),C=u&&u("atwKV",window.location.href)||C);var M={pg:{device:I,intl:D,property:x,rid:S,test:L}},T=(null==w?void 0:w.site_attribute)||"";if(L&&(T+=' Y-BUCKET="'.concat(L,'"')),r&&b){var B=T.match(p);if(2===(null==B?void 0:B.length)&&e){var j=e.getRapidAttribute("keys"),k=j.pd,U=void 0===k?"":k,V=j.pt,F=void 0===V?"":V,W=j.site,Y=void 0===W?"":W,H=j.ver,N=void 0===H?"":H;T=T.replace(B[1],"".concat(B[1],";pt:").concat(F,";site:").concat(Y,";ver:").concat(N,";pd:").concat(U))}T+=" "+b}else T=(null==g?void 0:g.sa)||"";C&&(T+=" ".concat(C)),-1===T.indexOf("ctout")&&(T+=" ctout=380");var _,q=function(i,n){var e,o;if(n)return null===(e=null==t?void 0:t.clusterPositionMeta)||void 0===e?void 0:e.positions.filter((function(t){return-1!==i.indexOf(t.id)}));var a=null===(o=null==t?void 0:t.clientPositionMeta)||void 0===o?void 0:o.positions;return a?a.filter((function(t){return-1!==i.indexOf(t.id)})):i.map((function(i){var n;return null===(n=null==t?void 0:t.positions[i])||void 0===n?void 0:n.meta}))}(o,r),J=[],K=(_=n.protocol+"//"+n.host,n.pathname&&(_+=n.pathname),_);if(null==q?void 0:q.length){for(var X=0,z=q;X<z.length;X++){var G=z[X];J.push(G.id),G.meta||(G.meta={}),G.meta.hostURL=K,R&&!g.ps[G.id]&&(g.ps[G.id]=Object.assign({},{id:G.id},h)),c.addPos(G)}R&&c.add(g),c.add(a,{name:a,ps:o,ref:n.href,sa:T,sp:(null==w?void 0:w.spaceid)||m||f,ult:M}),c.event(a)}}},g=function(i,n,e,o){if(void 0===o&&(o=!1),t){var a=window.DARLA;!a||a.inProgress()?function(i,t,n,e){w.push([i,t,n,e]),clearInterval(s),s=setInterval((function(){var i=window.DARLA;i&&(0!==w.length?("AUTO"===i.inProgress()&&i.abort(),i.inProgress()||m.apply(null,w.shift())):clearInterval(s))}),500)}(i,n,e,o):m(i,n,e,o)}},h=function(){var i=window.JAC;if(i){var t=i.getConfig().client.positions,n=Object.keys(t).filter((function(i){var n;if(null===(n=t[i].rotation)||void 0===n?void 0:n.enabled)return function(i){var t=window.wafer;if(!t||!i)return!1;var n=document.getElementById(i||""),e=n||{},o=e.clientHeight,a=e.clientWidth;return!!(n&&o>1&&a>1&&t.utils.elementInView(n,{offsetX:-a/2,offsetY:-o/2},t.base.viewport))}(t[i].targetElement)}));n.length&&i.fetch(n)}};!function(t){var n,e=t.adsConfig,o=t.wafer,a=t.YAHOO,r=a.context,d=r.device,l=r.feature,v=void 0===l?[]:l,u=r.meta;(void 0===u?{}:u).spaceId=null===(n=null==a?void 0:a.i13n)||void 0===n?void 0:n.SPACEID;var c="smartphone"===d?["LREC","LREC2","LREC3","WFPAD","WFPAD2"]:["LREC","LREC2","LREC3","LDRB","LDRB2","MAST","MAST2","MON"];function s(t){var n=(t||{}).elem,o=function(i){if(!i)return 0;var t=document.querySelectorAll("div.wafer-caas,div.wafer-caas-complete");return Array.from(t).findIndex((function(t){return t===i}))+1}(n);if(o>1){var a=[];!function(t,n,o){var a,r=(null===(a=null==e?void 0:e.clusterPositionMeta)||void 0===a?void 0:a.positions)||[];c.forEach((function(a){var d,l,v=t.parentElement.querySelector("#sda-".concat(a,"-iframe")),u=null===(l=null===(d=null==e?void 0:e.positions)||void 0===d?void 0:d[a])||void 0===l?void 0:l.meta;if(v&&u){var c="".concat(a,"-").concat(n);v.parentElement.id="cluster-".concat(c),v.id="cluster-".concat(c,"-iframe"),o.push(c),r.push(i(i({},u),{clean:v.parentElement.id,dest:v.id,id:c,pos:c}))}}))}(n,o-1,a),a.length>0&&g(t,a,"clusterAds",!0)}}o&&o.ready((function(){o.on("caas:article:pre:inview",s)}),t),-1!==v.indexOf("rotateJacOnVisChange")&&t.addEventListener("visibilitychange",(function(){"visible"===document.visibilityState&&h()})),setTimeout((function(){var i;null===(i=t.benji)||void 0===i||i.on("RENDER_FAILED",(function(i){var t,n;if("sda-WFPAD-iframe"===(null===(t=null==i?void 0:i.data)||void 0===t?void 0:t.id)){var e=document.getElementById("module-pencilAd");e&&(e.style.display="block",(null===(n=null==o?void 0:o.base)||void 0===n?void 0:n.sync)&&o.base.sync(e))}}))}),10)}(window)}();
//# sourceMappingURL=clusterSda.js.map
